<?php include __DIR__ . '/../header.phtml'; ?>

    <div class="col-md-12">
<?php if ($acl->isAllowed($user->role, 'modules', 'install')): ?>
        <form id="asset-search-form" action="<?=BASE_PATH . APP_URI . '/modules/upload'; ?>" method="post" enctype="multipart/form-data">
            <div><input class="btn btn-primary  input-sm" tabindex="2" type="submit" id="submit" value="Upload" /></div>
            <div class="form-group">
                <input type="file" name="upload_module" id="upload_module" class="file">
                <div class="input-group" style="width: 240px;">
                    <span class="input-group-btn">
        <button class="browse btn btn-default btn-sm input-sm" type="button"><i class="glyphicon glyphicon-search"></i> Browse</button>
      </span>
                    <input type="text" class="form-control form-control-sm input-sm" style="height: 30px;" disabled="disabled" placeholder="Upload Module">

                </div>
            </div>
        </form>
<?php endif; ?>
        <h1 class="modules-header"><?=$title; ?></h1>
<?php if (($newModules > 0) && ($acl->isAllowed($user->role, 'modules', 'install'))): ?>
        <nav id="sub-nav">
            <nav><a class="btn-sm btn-info" href="<?=BASE_PATH . APP_URI . '/modules/install'; ?>">Install (<?=$newModules; ?>)</a></nav>
        </nav>
<?php endif; ?>
<?php if (count($modules) > 0): ?>
<?php if ($acl->isAllowed($user->role, 'modules', 'process')): ?>
        <form id="modules-form" action="<?=BASE_PATH . APP_URI; ?>/modules/process" method="post">
<?php endif; ?>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Version</th>
                    <th>Description</th>
                    <th>Author</th>
                    <th>Installed</th>
                    <th>Updated</th>
                    <th>Active</th>
                    <th>Order</th>
                    <th class="col-md-1 text-center"><?php if ($acl->isAllowed($user->role, 'modules', 'process')): ?><input type="checkbox" name="check_all" id="checkAll" data-name="process_modules" value="" /><?php else: ?>&nbsp;<?php endif; ?></th>
                </tr>
            </thead>
            <tbody>
<?php foreach ($modules as $module): ?>
                <tr>
                    <td><?=$module->id; ?></td>
                    <td><?=$module->name; ?></td>
                    <td><?=$module->version; ?></td>
                    <td><?=$module->description; ?></td>
                    <td><?=$module->author; ?></td>
                    <td><?=date('M j Y g:i A', strtotime($module->installed)); ?></td>
                    <td><?=(!empty($module->updated)) ? date('M j Y g:i A', strtotime($module->updated)) : 'N/A'; ?></td>
                    <td><?php if ($acl->isAllowed($user->role, 'modules', 'process')): ?><select class="phire-select input-sm"><option value="1"<?=($module->active) ? ' selected="selected"' : null; ?>>Yes</option><option value="0"<?=(!$module->active) ? ' selected="selected"' : null; ?>>No</option></select><?php else: ?>&nbsp;<?php endif; ?></td>
                    <td><?php if ($acl->isAllowed($user->role, 'modules', 'process')): ?><input class="form-control form-control-inline form-control-sm input-sm text-center" type="text" name="order_<?=$module->id; ?>" value="<?=$module->order; ?>" size="2" /><?php else: ?>&nbsp;<?php endif; ?></td>
                    <td class="col-md-1 text-center"><?php if ($acl->isAllowed($user->role, 'modules', 'process')): ?><input type="checkbox" name="process_modules[]" value="<?=$module->id; ?>" /><?php else: ?>&nbsp;<?php endif; ?></td>
                </tr>
<?php endforeach; ?>
            </tbody>
        </table>
<?php if ($acl->isAllowed($user->role, 'modules', 'process')): ?>
        <div id="form-footer">
            <input type="submit" name="submit" class="btn btn-md btn-primary text-uppercase" value="Process" />
        </div>
        </form>
<?php endif; ?>
<?php else: ?>
        <p>There are currently no modules.</p>
<?php endif; ?>
    </div>

<?php include __DIR__ . '/../footer.phtml'; ?>